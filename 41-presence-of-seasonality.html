<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.336">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="James Livsey and Christoph Sax">
<title>Seasonal Adjustment in R - 12&nbsp; Presence of seasonality</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./42-annual-constraining.html" rel="next">
<link href="./40-part-other-issues.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><meta name="robots" content="noindex">
</head>
<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./40-part-other-issues.html">Other Issues</a></li><li class="breadcrumb-item"><a href="./41-presence-of-seasonality.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Presence of seasonality</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Seasonal Adjustment in R</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/christophsax/seasonalbook.content" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-getting-started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Getting started</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./20-part-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./21-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The fundamentals of X-13</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./22-transform.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Transform</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./23-regARIMA.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">regARIMA Model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./24-x11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">X-11</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./25-seats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">SEATS</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./30-part-data-problems.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data Problems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./31-holidays.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Irregular holidays</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./32-trading-days.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Trading days</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./33-outliers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Outliers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./34-seasonal-breaks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Seasonal breaks</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./40-part-other-issues.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Other Issues</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./41-presence-of-seasonality.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Presence of seasonality</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./42-annual-constraining.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Annual constraining</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./43-indirect-vs-direct.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Indirect vs direct adjustment</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./50-part-quality-assessment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quality assessment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./51-quality-measures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Quality measures</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./52-revisions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Revisions</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#basic-principle" id="toc-basic-principle" class="nav-link active" data-scroll-target="#basic-principle"><span class="header-section-number">12.0.1</span> Basic Principle</a></li>
  <li><a href="#available-tests" id="toc-available-tests" class="nav-link" data-scroll-target="#available-tests"><span class="header-section-number">12.0.2</span> Available Tests</a></li>
  <li><a href="#qs-test" id="toc-qs-test" class="nav-link" data-scroll-target="#qs-test"><span class="header-section-number">12.0.3</span> QS Test</a></li>
  <li><a href="#identifiable-seasonality-test" id="toc-identifiable-seasonality-test" class="nav-link" data-scroll-target="#identifiable-seasonality-test"><span class="header-section-number">12.0.4</span> Identifiable Seasonality Test</a></li>
  <li><a href="#case-study" id="toc-case-study" class="nav-link" data-scroll-target="#case-study"><span class="header-section-number">12.0.5</span> Case Study</a></li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/christophsax/seasonalbook.content/edit/main/41-presence-of-seasonality.qmd" class="toc-action">Edit this page</a></p><p><a href="https://github.com/christophsax/seasonalbook.content/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-presence-of-seasonality" class="quarto-section-identifier"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Presence of seasonality</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><div class="status">
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>You are reading an early draft of <em>Seasonal Adjustment in R</em>. This chapter should be readable but needs polishing.</p>
</div>
</div>
</div>
</div>
<p>Should a series be seasonally adjusted at all?</p>
<p>X-13 removes seasonality from the series, even if a series is not seasonal from the beginning. If a series is not seasonal, the resulting series may be bad.</p>
<p>Fortunately, X-13 contains a few tests that help users decide if a series is seasonal.</p>
<p>Before applying X-13, deciding if the series is seasonal may be necessary. This section discusses how to decide whether a series should be adjusted.</p>
<section id="basic-principle" class="level3" data-number="12.0.1"><h3 data-number="12.0.1" class="anchored" data-anchor-id="basic-principle">
<span class="header-section-number">12.0.1</span> Basic Principle</h3>
<p>In general, adjusting a non-seasonal series is less of a problem than not adjusting a seasonal series. So, unless you have good reasons to believe that a series is not-seasonal, adjust it. <em>If in doubt, adjust!</em></p>
</section><section id="available-tests" class="level3" data-number="12.0.2"><h3 data-number="12.0.2" class="anchored" data-anchor-id="available-tests">
<span class="header-section-number">12.0.2</span> Available Tests</h3>
<p>To help you to make a good decision, X-13 offers a few formal checks:</p>
<ul>
<li><p>The QS test is the primary test to evaluate seasonality both the original or in the adjusted series. It will be discussed in more detail in <a href="51-quality-measures.html"><span>Chapter&nbsp;15</span></a>.</p></li>
<li><p>The Identifiable Seasonality Test (IDS) gives a simple yes or no answer to whether a series is seasonal or not. It is available for X11 adjustments only.</p></li>
<li><p>The M7 statistic applies critical values to the Identifiable Seasonality Test (IDS) and returns a simple yes or no answer.</p></li>
</ul>
<p>Which tests are preferable, and how should a user decide if the tests are not aligned?</p>
</section><section id="qs-test" class="level3" data-number="12.0.3"><h3 data-number="12.0.3" class="anchored" data-anchor-id="qs-test">
<span class="header-section-number">12.0.3</span> QS Test</h3>
<p>The QS test has a few advantages compared to the IDS statistics and is generally preferable. It is available both with X11 and SEATS.</p>
<p>You can retrieve the results of the QS test by the <code><a href="https://rdrr.io/pkg/seasonal/man/udg.html">qs()</a></code> function. (We will say more about the QS statistic in <a href="51-quality-measures.html"><span>Chapter&nbsp;15</span></a>).</p>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">qs</span><span class="op">(</span><span class="fu">seas</span><span class="op">(</span><span class="va">AirPassengers</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     qs  p-val</span></span>
<span><span class="co">#&gt; qsori        167.64858 0.0000</span></span>
<span><span class="co">#&gt; qsorievadj   203.07731 0.0000</span></span>
<span><span class="co">#&gt; qsrsd          0.00000 1.0000</span></span>
<span><span class="co">#&gt; qssadj         0.00000 1.0000</span></span>
<span><span class="co">#&gt; qssadjevadj    0.00000 1.0000</span></span>
<span><span class="co">#&gt; qsirr          0.00000 1.0000</span></span>
<span><span class="co">#&gt; qsirrevadj     0.00000 1.0000</span></span>
<span><span class="co">#&gt; qssori       115.08988 0.0000</span></span>
<span><span class="co">#&gt; qssorievadj  135.11320 0.0000</span></span>
<span><span class="co">#&gt; qssrsd         0.36904 0.8315</span></span>
<span><span class="co">#&gt; qsssadj        0.00000 1.0000</span></span>
<span><span class="co">#&gt; qsssadjevadj   0.00000 1.0000</span></span>
<span><span class="co">#&gt; qssirr         0.00000 1.0000</span></span>
<span><span class="co">#&gt; qssirrevadj    0.00000 1.0000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The QS Statistic shows the degree of seasonality in various components of the seasonal adjustment. For our purposes, the first line is the most interesting. It shows that the QS value of the original series is 168, which comes with a p-value of essentially 0. This reads as there is a 0 probability that the null-hypothesis of seasonality in the original series can be rejected.</p>
<p>In other words, <code>AirPassengers</code> is a clearly seasonal series, which should not come as a surprise at this point.</p>
</section><section id="identifiable-seasonality-test" class="level3 page-columns page-full" data-number="12.0.4"><h3 data-number="12.0.4" class="anchored" data-anchor-id="identifiable-seasonality-test">
<span class="header-section-number">12.0.4</span> Identifiable Seasonality Test</h3>
<p>A second test for seasonality is the Identifiable Seasonality Test. It is only available in X11.</p>
<p>According to <span class="citation" data-cites="ONS07">UK Office for National Statistics (<a href="#ref-ONS07" role="doc-biblioref">2007</a>)</span>, a value lower than 1.150 (monthly series) or lower than 0.900 (quarterly series) indicates that seasonality is clearly present.</p>
<div class="no-row-height column-margin column-container"><div id="ref-ONS07" class="csl-entry" role="listitem">
UK Office for National Statistics. 2007. <em>Guide to Seasonal Adjustment with x-12-ARIMA</em>. <a href="http://www.ons.gov.uk/ons/guide-method/method-quality/general-methodology/time-series-analysis/guide-to-seasonal-adjustment.pdf">http://www.ons.gov.uk/ons/guide-method/method-quality/general-methodology/time-series-analysis/guide-to-seasonal-adjustment.pdf</a>.
</div></div><p>At the same time, a value between 1.150 and 1.250 (monthly series) or between 0.900 and 1.050 (quarterly series) indicates that seasonality may be present.</p>
<p>Values above 1.250 (monthly series) or 1.050 (quarterly series) point to non-seasonal series.</p>
<p>As we have stated above, the recommendation is to adjust the series unless you have clear evidence that a series is not seasonal.</p>
<p>Let’s try <code>AirPassengers</code>:</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">udg</span><span class="op">(</span><span class="fu">seas</span><span class="op">(</span><span class="va">AirPassengers</span>, x11 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="st">"f3.m07"</span><span class="op">)</span></span>
<span><span class="co">#&gt; f3.m07 </span></span>
<span><span class="co">#&gt;  0.203</span></span>
<span><span class="fu">udg</span><span class="op">(</span><span class="fu">seas</span><span class="op">(</span><span class="va">AirPassengers</span>, x11 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="st">"f2.idseasonal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; f2.idseasonal </span></span>
<span><span class="co">#&gt;         "yes"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The M7 value is way below the critical values. Accordingly, the Identifiable Seasonality Test indicates seasonality in the series.</p>
</section><section id="case-study" class="level3" data-number="12.0.5"><h3 data-number="12.0.5" class="anchored" data-anchor-id="case-study">
<span class="header-section-number">12.0.5</span> Case Study</h3>
<p>Consider the following less clear-cut series:</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/tsbox/">tsbox</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.seasonal.website">seasonal</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">1070.67782091276</span>, <span class="fl">1074.85048025033</span>, <span class="fl">1057.22943663105</span>, <span class="fl">1054.83329692382</span>,</span>
<span>    <span class="fl">1035.00741277933</span>, <span class="fl">1014.37654341674</span>, <span class="fl">1016.01971482192</span>, <span class="fl">1031.5736998743</span>,</span>
<span>    <span class="fl">1055.97206482734</span>, <span class="fl">1069.14603895638</span>, <span class="fl">1054.70695712307</span>, <span class="fl">1033.65404358999</span>,</span>
<span>    <span class="fl">988.507205808669</span>, <span class="fl">957.755772336067</span>, <span class="fl">936.185046914472</span>, <span class="fl">939.221279279722</span>,</span>
<span>    <span class="fl">962.250799500941</span>, <span class="fl">984.056833428967</span>, <span class="fl">999.390633761089</span>, <span class="fl">1033.68786613334</span>,</span>
<span>    <span class="fl">1055.87289736274</span>, <span class="fl">1097.92353618165</span>, <span class="fl">1114.50822274577</span>, <span class="fl">1148.65763657244</span>,</span>
<span>    <span class="fl">1199.32404772514</span>, <span class="fl">1208.39317300933</span>, <span class="fl">1185.13960320363</span>, <span class="fl">1154.58521771845</span>,</span>
<span>    <span class="fl">1101.7137166423</span>, <span class="fl">1053.89252948544</span>, <span class="fl">996.495317493457</span>, <span class="fl">926.283479008456</span>,</span>
<span>    <span class="fl">850.048912454291</span>, <span class="fl">809.84549670808</span>, <span class="fl">772.216576162406</span>, <span class="fl">784.114051995134</span>,</span>
<span>    <span class="fl">806.261273184001</span>, <span class="fl">820.618967152661</span>, <span class="fl">815.649757299053</span>, <span class="fl">812.501547645406</span>,</span>
<span>    <span class="fl">809.899692888929</span>, <span class="fl">823.778177350232</span>, <span class="fl">811.211453993884</span>, <span class="fl">814.868987237855</span>,</span>
<span>    <span class="fl">829.047528533717</span>, <span class="fl">831.891817984415</span>, <span class="fl">843.653707473654</span>, <span class="fl">895.684951210102</span>,</span>
<span>    <span class="fl">926.544452180194</span>, <span class="fl">949.41125175328</span>, <span class="fl">950.333376822119</span>, <span class="fl">994.228127170556</span>,</span>
<span>    <span class="fl">999.697246815797</span>, <span class="fl">1008.00877350773</span>, <span class="fl">1006.7566419533</span>, <span class="fl">990.419046839283</span>,</span>
<span>    <span class="fl">962.941704204873</span>, <span class="fl">947.541756501729</span>, <span class="fl">929.161895739204</span>, <span class="fl">910.588436791225</span>,</span>
<span>    <span class="fl">1248.42457644542</span>, <span class="fl">1266.67760866087</span>, <span class="fl">1248.78020047598</span>, <span class="fl">1290.47101093513</span>,</span>
<span>    <span class="fl">1328.51898051507</span>, <span class="fl">1356.02796471527</span>, <span class="fl">1363.37837075383</span>, <span class="fl">1398.27679451834</span>,</span>
<span>    <span class="fl">1399.20602270507</span>, <span class="fl">1391.19336700805</span>, <span class="fl">1387.13912745033</span>, <span class="fl">1346.03774501977</span>,</span>
<span>    <span class="fl">1370.73051832038</span>, <span class="fl">1346.29966480321</span>, <span class="fl">1340.09701324613</span>, <span class="fl">1331.07456050929</span>,</span>
<span>    <span class="fl">1321.82409348173</span>, <span class="fl">1343.5116656349</span>, <span class="fl">1366.41043298961</span>, <span class="fl">1363.10871463069</span>,</span>
<span>    <span class="fl">1391.84216974474</span>, <span class="fl">1417.38495449438</span>, <span class="fl">1432.17468812037</span>, <span class="fl">1394.40194160954</span>,</span>
<span>    <span class="fl">1385.72476381292</span>, <span class="fl">1388.23802327199</span>, <span class="fl">1354.10595421438</span>, <span class="fl">1345.15701390051</span>,</span>
<span>    <span class="fl">960.801527083357</span>, <span class="fl">941.027878841707</span>, <span class="fl">887.618178201697</span>, <span class="fl">842.12961787775</span>,</span>
<span>    <span class="fl">795.717159404159</span>, <span class="fl">757.35803147815</span>, <span class="fl">724.93681522789</span>, <span class="fl">716.66515476601</span>,</span>
<span>    <span class="fl">708.682334791168</span>, <span class="fl">689.925785264133</span>, <span class="fl">687.748168972216</span>, <span class="fl">688.809213406042</span>,</span>
<span>    <span class="fl">664.421326451325</span>, <span class="fl">661.822007527535</span>, <span class="fl">687.161046216216</span>, <span class="fl">684.548292412124</span>,</span>
<span>    <span class="fl">713.757983905367</span>, <span class="fl">729.917128362926</span>, <span class="fl">750.569868821847</span>, <span class="fl">745.544259228118</span>,</span>
<span>    <span class="fl">758.516668782925</span>, <span class="fl">758.841495662419</span>, <span class="fl">757.815323362363</span></span>
<span>  <span class="op">)</span>,</span>
<span>  frequency <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  start <span class="op">=</span> <span class="fl">1995</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://docs.ropensci.org/tsbox/reference/ts_plot.html">ts_plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="41-presence-of-seasonality_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p>If we apply standard SEATS seasonal adjustment, this does not seem to do anything:</p>
<div class="cell">
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/seas.html">seas</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="41-presence-of-seasonality_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="864"></p>
</div>
</div>
<p>What do formal statistics say?</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/udg.html">qs</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   qs   p-val</span></span>
<span><span class="co">#&gt; qsori        0.00000 1.00000</span></span>
<span><span class="co">#&gt; qsorievadj   0.08751 0.95719</span></span>
<span><span class="co">#&gt; qsrsd        0.00000 1.00000</span></span>
<span><span class="co">#&gt; qssadj       0.00000 1.00000</span></span>
<span><span class="co">#&gt; qssadjevadj  0.08751 0.95719</span></span>
<span><span class="co">#&gt; qsirr        1.81436 0.40366</span></span>
<span><span class="co">#&gt; qsirrevadj   1.81436 0.40366</span></span>
<span><span class="co">#&gt; qssori       0.00000 1.00000</span></span>
<span><span class="co">#&gt; qssorievadj  0.78501 0.67536</span></span>
<span><span class="co">#&gt; qssrsd       0.26233 0.87707</span></span>
<span><span class="co">#&gt; qsssadj      0.00000 1.00000</span></span>
<span><span class="co">#&gt; qsssadjevadj 0.78501 0.67536</span></span>
<span><span class="co">#&gt; qssirr       1.92576 0.38179</span></span>
<span><span class="co">#&gt; qssirrevadj  1.92576 0.38179</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s have a look at the first line. A QS value of 0 has a p-value of 1, meaning the Nul-Hypothesis of seasonality in the orgininal value can be savely rejected. According to this measure, it is clear that this series has no seasonality.</p>
<p>If we want to consider the M7 values, we need to use X11:</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">m_x11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/seas.html">seas</a></span><span class="op">(</span><span class="va">x</span>, x11 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The QS statistic has to be the same for the unadjusted series but not for the adjusted one:</p>
<div class="cell">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/udg.html">qs</a></span><span class="op">(</span><span class="va">m_x11</span><span class="op">)</span></span>
<span><span class="co">#&gt;                   qs   p-val</span></span>
<span><span class="co">#&gt; qsori        0.00000 1.00000</span></span>
<span><span class="co">#&gt; qsorievadj   0.08751 0.95719</span></span>
<span><span class="co">#&gt; qsrsd        0.00000 1.00000</span></span>
<span><span class="co">#&gt; qssadj       0.00000 1.00000</span></span>
<span><span class="co">#&gt; qssadjevadj  0.00000 1.00000</span></span>
<span><span class="co">#&gt; qsirr        0.00000 1.00000</span></span>
<span><span class="co">#&gt; qsirrevadj   0.03306 0.98361</span></span>
<span><span class="co">#&gt; qssori       0.00000 1.00000</span></span>
<span><span class="co">#&gt; qssorievadj  0.78501 0.67536</span></span>
<span><span class="co">#&gt; qssrsd       0.26233 0.87707</span></span>
<span><span class="co">#&gt; qsssadj      0.00000 1.00000</span></span>
<span><span class="co">#&gt; qsssadjevadj 0.00000 1.00000</span></span>
<span><span class="co">#&gt; qssirr       0.00000 1.00000</span></span>
<span><span class="co">#&gt; qssirrevadj  0.08751 0.95719</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Because we use X11, we can now have a look at the M7 value:</p>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/udg.html">udg</a></span><span class="op">(</span><span class="va">m_x11</span>, <span class="st">"f3.m07"</span><span class="op">)</span></span>
<span><span class="co">#&gt; f3.m07 </span></span>
<span><span class="co">#&gt;  1.222</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you look for simple answers, the <code>"f2.idseasonal"</code> gives you a simple yes or no answer. From the previous discussion, it should not be surprising that the answer is <em>no</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/seasonal/man/udg.html">udg</a></span><span class="op">(</span><span class="va">m_x11</span>, <span class="st">"f2.idseasonal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; f2.idseasonal </span></span>
<span><span class="co">#&gt;          "no"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>



</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./40-part-other-issues.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Other Issues</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./42-annual-constraining.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Annual constraining</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">by James Livsey and Christoph Sax</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Seasonal Adjustment in R</div>
  </div>
</footer>


</body></html>